cc = clang
cflags = -Wall
builddir = out

rule cc
  command = $cc $cflags -c $in -o $out

rule link
  command = $cc $in -o $out

build $builddir/sbuf.o: cc sbuf.c
build $builddir/sbuf_test.o: cc sbuf_test.c
build $builddir/sbuf_test: link $builddir/sbuf.o $builddir/sbuf_test.o
